<html>
	<head>
		<title>a</title>
		<link type="text/css" rel="stylesheet" href="css/popup.css" />
		<script type="text/javascript" src="js/jquery.js"></script>
		<script type="text/javascript" src="js/global.js"></script>
		<script type="text/javascript" src="js/background.js"></script>
		<script type="text/javascript">
			/*
			 //get all the group and show them in the list
			 function fillGroupList() {
			 var groups = [];
			 for(var g in window.group)
			 groups.push(g);
			 groups.sort();
			 for(var i=0; i<groups.length; i++) {
			 var val = groups[i];
			 $("ul.template.groups-list").children().clone().appendTo('#groups')
			 .find('input[type=text]').val(val).data('oldname', val);
			 }
			 }

			 $( function() {
			 //destoryGroup();
			 initGroup();
			 fillGroupList();
			 //create group
			 $('[name="createbtn"]').click( function(event) {
			 var val = $("[name='groupname']").val();
			 if(val && createGroup(val)) {
			 $("ul.template.groups-list").children().clone().appendTo('#groups')
			 .find('input[type=text]').val(val).data('oldname', val);
			 } else if(!createGroup(val)) {
			 alert('group ' + val + ' exists');
			 }
			 });
			 //delete group
			 $('button.delete').live('click', function() {
			 var unit = $(this).closest('li');
			 var name = unit.find('[type=text]').val();
			 unit.remove();
			 deleteGroup(name);
			 });
			 //rename group
			 $('button.rename').live('click', function() {
			 var oldname = $(this).prev('[type=text]').data('oldname');
			 var newname = $(this).prev('[type=text]').val();
			 renameGroup(oldname, newname);
			 $(this).prev('[type=text]').data('oldname', newname);
			 });
			 $('#domain-list select').change( function(event) {
			 var time = $(':selected', this).val();
			 var obj = jQuery.extend(true, {}, window.time_tracker);
			 var groups = [];
			 for(var g in window.group)
			 groups.push(g);
			 groups.sort();
			 for(var i=0; i<groups.length; i++) {
			 var list = Statistics.get(time, groups[i]);
			 if(list.length == 0)
			 continue;
			 list.sort(createComparisonFunction('time'));
			 var totaltime = Statistics.gettimeingroup(list);
			 $('ul.template.domain-list').children().clone().addClass(groups[i]).appendTo('#domain-list')
			 .find('span.group-name').text(groups[i]).end()
			 .find('span.group-time').text(totaltime);
			 for(var i=0; i<list.length; i++) {
			 $('ul.template.group-domain').children().clone().appendTo('#domain-list li.'+groups[i]+' ul')
			 .find('span.domain-name').text(list[i].domain).end()
			 .find('span.domain-time').text(list[i].time);
			 delete obj[window.domainmap][list.domain];
			 }
			 }

			 }).change();
			 });*/
			var urls = {'vbird', 'weibo', 'douban', '127.0.0.1', 'baidu', 'google'};
			var groups = {
				work: ['vbird', '127.0.0.1'],
				search: ['google', 'baidu']
			};
			
		</script>
	</head>
	<body>
		<ul>
			<li>work</li>
			<ul>
				<li>vbird</li>
				<li>127.0.0.1</li>
			</ul>
		</ul>
		<div class='template group-checks'>		
			<div class='checks-control'>
				<a class='checks-add' href="#">add new group</a>
			</div>
			<div class='checks-add-form'>
				<input type='text' name='new-group'/>
				<button type="button" name="new-group-submit">create</button>
				<button type="button" name="new-group-cancel">cancel</button>
			</div>
		</div>

		<!--
		<div id="group">
		<div>
		<input type="text" id="groupname" name="groupname" />
		<input type="button" name="createbtn" value="Create Group" />
		</div>
		<ul id="groups">
		</ul>
		</div>
		<div id="domain-list">
		<select name="time">
		<option value="today">today</option>
		<option value="total">total</option>
		<option value="yesterday">yesterday</option>
		<option value="thisweek">thisweek</option>
		<option value="lastweek">lastweek</option>
		</select>
		</div>
		<ul id="domain-list">
		</ul>
		<ul class='template domain-list'>
		<li>
		<span class='group-name'></span>
		<span class='group-time'></span>
		<ul></ul>
		</li>
		</ul>
		<ul class='template group-domain'>
		<li>
		<span class='domain-name'></span>
		<span class='domain-time'></span>
		</li>
		</ul>
		<ul class='template groups-list'>
		<li>
		<input type="text" name="groupname" />
		<button type="button" class='rename'>
		rename
		</button>
		<button type="button" class='delete'>
		X
		</button>
		</li>
		</ul>-->
		<script type="text/javascript">
			/*function getSecFromFormat(ss) {
			var pattern = /(\d+d)?(\d+h)?(\d+m)?(\d+s)/,
			rights = [24*60*60, 60*60, 60, 1],
			secs = 0;
			var match = pattern.exec(ss);
			for(var i=1; i<5; i++)
			secs += match[i] != undefined ? parseInt(match[i])*rights[i-1] : 0;
			return secs;
			}

			alert(getSecFromFormat('11m23s'));
			alert(Date.getyesterday());*/
			//------------------------------------------------------------------------------
			//test the group
			/*
			destoryGroup();
			initGroup();
			alert(localStorage.time_tracker_group);
			createGroup('work');
			alert(localStorage.time_tracker_group);
			createGroup('weibo');
			alert(localStorage.time_tracker_group);
			addDomainToGroup('http://weibo.com', 'weibo');
			alert(localStorage.time_tracker_group);
			addDomainToGroup('http://www.douban.com', 'weibo');
			alert(localStorage.time_tracker_group);
			deleteGroup('work');
			alert(localStorage.time_tracker_group);
			deleteDomainFromGroup('http://weibo.com', 'weibo');
			alert(localStorage.time_tracker_group);
			renameGroup('weibo', 't');
			alert(localStorage.time_tracker_group);
			*/
			//alert(Date.getlastweek());
			//destory();
			/*
			var d1 = 'http://www.douban.com', d2 = 'http://www.google.com.hk';
			init();
			//alert(localStorage[root]);

			addDomains(d1);
			addDomains(d2);
			starttimer(d1);
			alert('...');
			stoptimer(d1);
			starttimer(d2);
			alert('...');
			stoptimer(d2);
			alert(JSON.stringify(window.time_tracker));
			*/
			//---------------------------------------------------------------------------------------
			//test the Statistics
			/*
			 var list1 = Statistics.get('total');
			 alert(JSON.stringify(list1));
			 list1 = Statistics.get('lastweek');
			 alert(JSON.stringify(list1));
			 destoryGroup();
			 initGroup();
			 alert(localStorage.time_tracker_group);
			 createGroup('work');
			 alert(localStorage.time_tracker_group);
			 createGroup('weibo');
			 alert(localStorage.time_tracker_group);
			 addDomainToGroup('http://www.douban.com', 'weibo');
			 alert(localStorage.time_tracker_group);
			 list1 = Statistics.get('yesterday', 'weibo');
			 alert(JSON.stringify(list1));
			 alert(Statistics.gettotaltime('yesterday', 'weibo'));*/
		</script>
	</body>
</html>